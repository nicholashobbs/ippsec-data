 hello I'm Nick Eppolito and this is going to be a speedrun of all five terminals in sans holiday hat challenge 2016 if you don't want the sans holiday had challenges essentially it's a challenge that sans puts on every year in the last two years they have integrated browser quest in it which is their platform you walk around talk to little elves in the game get hints and then you can also click on these little tumors on the wall you probably can't see it that well because everyone's huddled around it because everyone's trying this challenge right now but when you click it it pops open a interactive session within the game really slick and really fluid but we will not be doing it out of this window instead we will be accessing it over its web address because I don't want to walk to each terminal in the game so the first challenge tells us to find the passphrase inside of /out dot P cap so doing an LS dash L a on slash we can see the alt pcap file is owned by itchy and it's only itchy can read that file doing a Who am I reveals that I am scratchy so if I try to do anything with that pcap file I get a permission denied doing sudo space dash L tells us that the scratchy user made run the following commands as itchy TCP dump and strings so to verify that we're gonna do sudo - you itchy strings slash LP cap and indeed we can now access that file but strings doesn't really help us too much I'd rather analyze a pcap file and Wireshark because that's what I do TCB dump has the ability to read a pcap file in write a pcap file and looking at the you mask setting we see it as zero zero two two which means new files will be read right by the owner but also read every one so if I do touch slash tab slash test do it LS - LA on slash temp we see that read for all users is set so we're gonna run the sudo command again TCP dump - Doug r4 read out pcap - w-4 right slash temp /lp Cal and then do it LS - la on slash temp and we see the pcap file is there and anyone can read the file so we're gonna go into the temp directory and the only thing we have to do now is somehow get this pcap file on our system running an IP address reveals that there's only a local host on this so we can't expel this over the internet but we could do base64 and copy it so we're gonna run base64 slash out pcap and that's going to put this in slash temp slash althought pcap and this puts in a format that a browser we can put in a clipboard and copy and paste it so we're gonna go to the top of the file highlight enter to go to the bottom highlight everything copy and then go into a terminal go into a directory to stay organized and I'm gonna remove out pcap in second half because that is from me doing it earlier today due out pcap be 64 and I would paste this in but this takes about three minutes to paste so I've already had this set up so now you're gonna do base64 space D out pcap and we're going to direct this into al pcap now when we do Wireshark out that pcap we should be able to analyze this file I'm going to click on get first half dot HTML right click follow TCP stream and we can see part 1 and the you is Santa's li so we got the first half of the password we're going to filter out this dream and we see the second half is right here so I'm going to right click follow TCP stream this file looks like it is a binary file as indicated by the dot bin and why should cannot read this so we're gonna save this over as raw save this into a directory as second half I open up a terminal window we can close out of Wireshark we're gonna run strings again second half and know we couldn't read it but strings has multiple encoding options so we're gonna do strings - H and we see the different option we can do as s B or L lower case indicates seven bit up case indicates eight bit so we're just gonna run through these real quick strings - e capital space s space what I call it second half that looks very familiar to what we just ran before so that's probably the native format of strings linscheid - beat and we get TT le helper so the passphrase is santa's little helper which we probably could have guessed because the itchy and scratchy of course characters and Simpsons and santa's little helper is the dog in simpsons so after saying Santa Li you may have been able fill in the rest but that'll be it for the first terminal going to the next channel which is on port 6000 three or six hundred thousand three I don't know exactly how to say that number but to open the door find the passphrase deep in the directory so we do a fine space stop and there is a lot of characters that will be heard to type in a command because backs like I've heard of type a space so if we just did CD dot doormat then oh it killed a TTY so what we're going to do is type bash so now we have tab autocomplete but if we do like CD doormat space tab it doesn't work I'd have to escape the no its dot space tab I'd have to escape the space by putting a backslash space and now I could autocomplete and I could keep going through this or I could just run fine dot and I see there's a file called key for the door text I'm gonna guess that's where the key is so I'm gonna copy that we're gonna do find - name key and find doc - name key so now we have only this line of the output of a fine command and then we can specify - exact space cat and we get the key Open Sesame so what I just did was tell the find command to execute every file with the word binary cat and it did all the escaping for me so the that key is Open Sesame the next challenge is I play the game Wampus play fair a cheat it's up to you if you execute Wampus it is a text-based game so we're going to do the same thing we did with the pcap file and that's base 64 Wumpus so we can copy this to our computer you scroll all the way up highlight the beginning and enter to go down ctrl C to copy go over to a terminal I think I have this in CTF Holliday half challenge terminal ok and go into the Wampus directory and I already have this in base64 pasted because this takes a few seconds to paste so for ease of use we're just gonna now base64 word - deed direct that to Wampus to be safe we're just gonna md5 sum make sure they're the same file 1 0 0 4 go back into Wampus md5sum 5c c4 so that's different that should have been the same now I'll just paste this in because if I execute Wampus what happens game works so maybe there's something hard-coded in this that changes every time but to be safe we're going to use the correct version but make sure I basics d4 is the same so now I just pasted it in base64 - D Wampus to overwrite Wampus md5 sum on Wumpus 5c c 4 if i see ok that looks much better when we run gdb to debug the game winner on info functions and see the binary is not stripped we have a function called whomp kill that looks interesting so we're going to run the game with our go back to gdb press ctrl C I'm gonna print whomp kill I think there's another function called kill whomp I think this the one will Wampus kills us so kill whomp and we see the passphrase is Wampus is must understood so that's how you do that challenge but actually cheat in that challenge go to the next terminal and it says greetings professor Falken so this is a wargames reference well you just have to type everything but I make a lot of mistakes so I wrote a X do tool script will go into that what this does is essentially just allows me to script my keyboard so if we go into wargames V wargames dot X do we see it's going to search for the window with a title of weddy which is the title of the war game window and it's going to type to come hello period hit return that's gonna wait one second type I'm fine how are you hit return that's gonna type people sometimes make mistakes hit return and so on so we're gonna execute this went to my firefox window and now it's typing all the responses it looks a little bit funny because it's not waiting for the computer to finish typing back before it sends a response but we can see it going through and now the machine's gonna put a picture of the US and Russia and ask which side we prefer in the movie were the Russians so we picked the Russians yet again and once all this prompt finishes we should have the flag waiting for a strike command it's asking where do we want to nuke and we got it look at the pretty lights was the Kia for that one so going to the final terminal which is on six hundred thousand six were prompted with this menu and we're supposed to make this train go so if we click type start check and brakes the brakes must be off so when tight brake off start and it's going to ask us for a password which we don't know so when type help because helps are normally helpful and we see a hint right here that has less in capital and this looks like a less terminal and less has a command escape where if you hit exclamation point you can run any command so if we do estimation point bin slash SH we get to the terminal and then we can just mainly run the active train activate train binary and begin the time jump and that will conclude all five terminals hopefully you enjoyed this video take care guys bye