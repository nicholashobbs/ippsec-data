 what's going on YouTube this is IPSec and will be changed in a bit this week and doing a video for the blue team because last week we showed you how to take mini cats and have it bypassed defender so naturally this week we're gonna show you how to set up a logging system to detect mini cats and oh so much more just based upon the behaviors of the program the goal of antivirus is to stop infections before they happen and it does that by creating that signature file and watching what happens on your disk realistically that's not a great way to stop all hackers namely like insider threats that don't even need programs to do any badness having a system that watches the behaviors lets you detect that insider threat additionally it makes sure your network isn't schr√∂dinger's Network because there's so many companies that just never look for a KERS so they assume they've never been act but once you open Pandora's Box chances are you will find badness but anyways if you're on the red team there's probably gonna be tidbits throughout this video that help you stay hidden and if you know how the blue team is looking for you you know not to do those things so let's get into perhaps the most important part of this whole video will be this right here understanding the basic architecture of what we're building because without that if we run into issues or want to make modifications we're just Sol so we're gonna be building the Hulk stack which is an elk stack that is pre-configured for threat hunters East stands for elasticsearch this is the database L stands for log stash this grabs information enriches it and puts it into the database K stands for Cabana this is a web interface to the database so we can query it and then Oeste alert is pretty new it's gonna appear actually pull the database for things and then create alerts on them the whole pre-configured part this threat hunter part starts with when log beat this is software that runs on Windows clients and posts information out of the event log it will send it into Kafka which is a message broker logstash gets information from Kafka will enrich it and then put it into elasticsearch by enriching I mean just kind of index it and tell elasticsearch what each piece of the event log is and then Cabana this will have dashboards ways to search all the event logs and then Sigma these are indicators of compromise this will search elasticsearch PR periodically for just badness perhaps like dirty words from powershell mini cats IOC s etc there's also this K SQL piece which monitors Kafka and does some fancy things to join event logs together and then we can just ignore Hadoop Spock Jupiter graph frames because I don't know enough about them to do a video on this so perhaps that would be a future thing with all that being said let's jump in instant installing help so here we have a relatively fresh copy of ubuntu Bionic which is 1804 I've assigned this one CPU which I probably should have added more CPUs in hindsight and I've also gave Annette 10 gigs of RAM you can probably get away with like five or six gigs of RAM but I wanted to add more just in case I decide to do more videos on this it requires eight gigs for that Jupiter Hadoop and all that stuff so that's why I went above eight the other thing I wanted to do is show you the commands I've ran I've just installed two packages that it's open-vm-tools and T MUX and here I was just setting my IP address to a static reservation so I ran IP addr notice my IP address with some high number I decided to create a static reservation my DHCP server I cleared my reservation on my client and pulled a new IP address so with all that said we can now install the elk stack so let's open up Firefox and go Google github help and then go to cyber war dogs repository copy this and go back and do a git clone we need to install git I need to do that in sudo and now we can do the git clone operation and while that clones I do want to go into the wiki and the installation process and that we go down I'm just looking for the log that was supposed to tail so he can watch the install process to make sure nothing goes wrong and now we have help installed so we go in to help docker I'm going to do sudo dot slash health to underscore install and before I do that I'm gonna do T MUX new so sudo dot slash health install Sh password and we're gonna be building number one we're not doing spark and Jupiter the subscriptions gonna be basic the IP address that's going to be pre-configured to whatever your IP is the UI passwords gonna be hunting and we just want to type hunting to validate that and now it's installing HT passwd and I'm gonna paste that command I copied from the page which is the install log and we can just watch this go and I'm going to fast forward the video and we'll resume once everything is installed looks like the install is done after about 15 minutes so I can exit this and one thing we want to do before we actually get into health and start configuring a client is just take a poke around the doctor images to understand what's happening so we run sudo docker PS to list running containers and that is ugly I'm gonna pipe that to less with a - capital S and that's gonna get rid of the line wrapping and put everything on one line so we can easily read it and we can hit the right arrow to go over and we want to look at the let's see it is the log stash container and we'll also want to look at the Alaska alert container after that for the Sigma rules so let's do a sudo dr. exec - IET specify the image name and the command we want to run which is just bash and now we are in the doctor container for last logs - so let's go into the pipeline and this is all the logstash rules let's just do an LS that prints better and it's organized by number and the earlier numbers get executed first and the higher numbers get executed last so the very first thing we have is oh oh oh - Kafka input and if we look at this it's just us connecting to the CAFTA broker and searching for the topics when Wald beat sis montjoy and file beat and then pulling them and setting them through the pipeline it'll hit things like the win event sis Mon filter and we'll see what this one's doing and that's just a bunch of JSON to organize what the system on is so it's gonna see the system on event ID - and gonna say that is a file creation event event ID threes Network connect and one is process create will go through all these and dig through them and a little bit and then near the end we'll have things like the output and this is it sending it to what is it elasticsearch so we're looking at the whim event power shell output and we're saying if the log is Microsoft Windows PowerShell or PowerShell send it to elasticsearch port 9200 and we don't have a password it looks like just using them username elastic because I'm guessing elasticsearch is not listening on a routable IP so it's just doing Network authentication I guess you could say so that's all we want to look at for log stash the next is a Laster look which contains all the Sigma rules so let's just do a dr. PS West - s again we need sudo and then go all the way over and copy help - blaster alert and do the same thing so sudo docker exec - I T the container name best to enter the container and then the rules are in opt Sigma rules and we can see six or seven directories where all the rules are stored and there's application apts Linux Network proxy web in Windows and let's just start with apt because no one can seem to catch these guys so let's look at a PT cloud hopper gamal we can see this rule is looking at Windows sis Mon for event ID one which I know it to be a process create and it's looking for anything with the image of C script exe and it contains dot VBS Base /l so this is probably just something there's a PT's generally did and it can be considered an indicator of compromise there are other ones so we can look at like apt dragonfly and this one is using the process name crack map exact which is kind of funny so you can take a look at those rules we can also go into Windows which has a bunch of other rules like PowerShell ones and if we look at PowerShell suspicious download yeah Mille we see this is just looking for system got net web client download string or download file there are things like X or command line let's see what this one's looking at this is actually Window System on process create I was looking for a - BX or that is organized oddly compared to the other ones I've looked at so we can go into like sis Mon rules and there are a bunch of them let's look for what is Mimmi cats and we can look at the Sigma rule for detection of else ass this is the process that stores all the credentials so we can see this one is looking for event ID 10 which I don't know what that is if we go go windows sis Mon event 10 and go to this this is process access so this is going to be some process is ax saying LSS and it's asking for the grant access of 1410 will probably dig into exactly what this means later in the video so there were two with mini cats let's look at in memory detection and we can see this one's just looking at a bunch of dll's loading I guess event ID seven is probably like DLL load so if we look at this event ID we'll just go back sis mod windows event 7 and that is image loaded so this ultimate Windows security comm is actually a really good site for looking at any Windows Event log so see another one there is I think safety cats so we can look at system on ghost pack safety cats and this is a dotnet implementation of mini cats that does things a little bit safer and this one is doing event ID 11 which I believe is a file create and it's looking for the file name temp debug bin so what safety cats is doing instead of accessing the L SAS process it is telling a legitimate Windows process to dump the memory to this location and that is a bit noisier so you can't just look on that so they decided to alert on the file create of where safety cats rights files so if you wanted to start evading these things you can look at the rules that people use to detect and slightly modify them so if I was building a copy of safety cats I probably wouldn't write to temp debug bin I would probably write to temp not debug bin so we can get out of all these and then start beginning to configure our Windows client so this is a pretty vanilla build of Windows the only things I've really installed was Google Chrome notepad plus plus sublime and get I did one use the commando install that we did last week because it does a bunch of modifications that may just conflict with the logging we're trying to enable so the first step is to install sis Mon and before we install this mod we should make Asus mod configuration file and my favorite way of doing that is doing the system on modular configs because the config for sis mon is ginormous so if we look at like a example config it is this and trying to manage this giant file is a pain so the modular system on kind of breaks it up and to smaller things that you put in directories so if we wanted to exclude VMware Player we put that in this directory and then when it generates it builds the entire system on config SuperDuper handy and would recommend it so let's copy this open up a command prompt and I probably should make this a bigger font so we'll do edit properties font can be 24 I guess and that will go into documents and do a git clone and paste this this mod modular thing and before we can do system on modular we need to install PS system on tools so let's clone this as well get clone BSS mod tools' and we'll have to import that project so if we do a dir we want to get to this directory and we can do import module I think was it important module is that what it says to do here generate input - module oh I'm not in PowerShell duh so launch powershell and then import - module and we should do the PSM one file and we can't load it because their execution policy so let's change that to bypass and we have to opens command prompt in administrative mode so I'm gonna press control shift enter that prompts the UAC dialog and then we can go back to users if SEC documents launch powershell and do a dir go into PS system on tools and we can import that module again there we go and I have to set the execution policy DejaVu and this time the command will finally work and we can go into the system on modular and then we just execute the generate system on config and it's going to back up the config and generate a new configuration if we do a dir we can see the back dub config and then we got a new one so now we have to go download this one so I can just search download sis Mon and we'll be on Microsoft's website and installing system on super easy you just pretty much specify sis Mon - I I believe so we can minimize that copy this - I guess the desktop I'm gonna move this into the documents say smart modular and then we'll install it there so we just do sis Mon I'm gonna do - H first and we see all the flags we want to do - I to install the service and Driver so we'll do sis Mon - I and then the config so sis Mon config.xml we'll accept the EULA and now we have successfully installed sis Mon so if we look at our services maybe I need services.msc there we go we should have a system on here 6 months 60 4 and it's set to automatic so - stood up the next time we reboot the box as well so that's done but there's also a bunch of other logging that we want to do such as command line logging powershell script logging tasks event logging just all the logs so i'm going to open up a MMC console and then there press ctrl M to open up the add/remove snap-in I'm going to type GP to get to group policy object all a to add it Anna Anna and now we're in this and this is very much like group policy we could manually enable this through the registry but this way if you're trying to deploy it on a lot of computers it'll be pretty much the same you should be familiar with this interface so the first thing I want to do is enable the command line logging and that is under I believe Windows security settings and then advanced audit policy configuration system audit policies and detail tracking there we go we got to enable the process creation and then there is also one to enable these advanced policies and that one is under I think local policies security options and then audit force audit policy subcategory this is what I want to do if you have questions you can just read the explanation Microsoft's pretty good at documenting these things but that's going to enable these advanced audits and then we also have to enable the detail tracking or actually the verbose because right here we just enabled the process creation so that one is under administrative templates and then windows components no I think this one is system and then audit process creation there it is and we can enable this and now this will have command line logging enabled so if we did a command like it's actually exit PowerShell so it's not captured in PowerShell walking but we'll do the command net user hacker I love comments slash add and we can also then delete this user so this should show up in our logs so when we install when log beat hopefully we'll be able to see this inside of our elk stack so the last thing we want to do is well second or last we probably want to enable PowerShell logging and that one is under administrative templates windows components and then Windows PowerShell or is it here we go and we want to turn on modular logging and the module name will do all the modules so we'll just put a star and then we can do script block logging enable this and let's for the heck of it log start and stop events script execution this is the bypass thing so we don't need to touch that PowerShell transaction if we enable this and put a directory it'll write the PowerShell script to that directory I believe this is what commander does if you notice when you run PowerShell it creates a directory on your desktop and shows you all the PowerShell you ran so since we're walking in an event log I'm not going to enable that and then for this we should also add some things to our PS home variable so that is in C colon windows system32 windows powershell v 1.0 and if we create the file profile ps1 that should execute any time we open PowerShell and I can only create folders because of UAC so let's just create something to the desktop so we just want a PowerShell faulted set log command health event to true and we also want to do log command life cycle event equals true and you can just google these things to figure out what they are essentially the first one is going to enable like logging of errors and I forget what this one does let's just google this this one specifically logs the starting and stopping of commands so create these two and we can verify that they will actually work by loading PowerShell here and we can do echo this well we just have to paste that and we see nothing is there let us save this to the desktop as profile ps1 and then copy it into that folder so we saved it and let's move it into here continue and now when I do PowerShell and the same command we see it is true so now we know that is setup and the final thing we want to do is enable the task scheduler walking so I'm going to open this up and then I'm just going to click this to enable all tasks history I'm not sure how to set this in group policy if you google it there are PowerShell commands or Windows commands to set it so yeah that should handle all our logging and now we can install the win log beat so let's search for win log beat and we want to download it and installation steps where is the download 64 bit so we can open this and then copy it to our desktop and then go from a command prompt to a desktop do a dir win log beat and we probably want to edit the configuration file we're quick so let's do open desktop win log beat when log beat ya mole and then we want to this is not it oh this probably a win log beat file on the repo for help so we do help github go to cyber war dog and then let's see here's when long beat when long beach Amal and let's copy this file so ctrl C to copy go to notepad paste it save and we need a set or Hulk IP and I believe I was 172 16 10 10 save that and it says if you only have one Kafka instance which is the default for Hulk remove the second one which is why I remove that so X out of that let's go back to a command prompt and we want to go in a PowerShell and install service when log beat and we can go into the services that's not it services.msc and look at when log beat we see it's automatic but not started so I'm going to hit enter and click start to start the service and we should be getting information inside of Hulk now but because this is Windows I am going to reboot it to make sure we get all the information because I'm not sure if all that like command line logging actually took effect now or does it at next reboot so to be safe I'm just going to reboot Windows just finished rebooting so I'm going to open up services make sure everything is started and then we'll take a look at elastic search so if we search for sis Mon that is running and then win log beat and that is running as well so let us open up Chrome so we can look at the Hulk stack so go to 172 16 10 10 and then accept the privacy warning and then the password was forget what the password was it's let's see let's go help github I know the password was hunting I don't know the user so search for hunting let's go to install that's not installation hunting so let's see UI password is hunting what is the user name is it hunting refresh hunting hunting elk hunting okay use name is health password is hunting and this is the I guess homepage of Cabana we could go to dashboards and look at system on dashboard to see if there's information and if there's information in this then we did a good job we have 369 system on events these things aren't working I'm not sure what those are what we can see bunches and bunches of things so let's go over to the discover and we're going to change your search for let's do security I think this is where the command line logging is and we can look for net user and let's see that grab for user or net user but here we can see the actual commands and we can see the event ID is four six eight eight so let me make this font bigger first so that should be better but event ID is four six eight eight so I can look at event let's go options turn on query features so we can do event ID and then equals the value which is colon and then put four six eight eight that should have worked maybe it's not in quotes nope maybe we don't do the comma and I think yep this searched only for four six eight eight so if we look at one of these events we can look that that it's a process create and here is the command line so let's do process name we'll put this in the column table and then process command line we'll also interested in and then if we go up here and minimize that role we can see what every process is doing and if we go all the way back we should be able to find a process with net user let's see let's just search these so here's me launching new pad plus plus speech runtime net one exe and here we go we have net one user hacker slash delete and we also have us creating the user with net user hacker I love comments / add so this is why like having logging is beneficial we could also just let's go back to our health instance and host a file so dev sh m and we'll do V attack and we'll call this owned is equal to true and then we'll do Python M simple HTTP server we need Python three so Python 3 M HTTP server and then we can go back to our windows and go into powershell and i'm gonna go in command prompt to make the font bigger then powershell and i'm going to do is new object net dot web client download string HTTP 10 172 16 10 10 colon 8000 attack and let's see is true I did that wrong let's do owned is equal to true like that maybe we'll put lol Oh said again and let's run this there we go so if we look in PowerShell logging so we can look at logging PowerShell and we're not getting any oh because we have event ID four six eight eight refresh probably none from that time so we can set the time to be quick and we'll do today and we want to get rid of process name and process command-line and we here we have all the PowerShell logging so we can see right here at this event we have the PowerShell logging saying invoke expression and the setting the value of owned to true and this is that error message so a little bit after that you probably have the lol and that's setting a variable so we can just let's look at this to toggle column and table and then minimize this and we can just see all the PowerShell things so there is us running code is equal to lol and this is the error message that the true generated earlier and you can see us installing when log beat so super handy logging so now let's do something with mini cats so before I do this let us set defender to ignore stuff in our documents because I don't want it to flag on the actual source so let's see we're going to pretend that we have bypassed a defender and it was hoping to do this video when we had a copy of mini cats that ignored it but didn't feel like creating another because 24 hours after creating it and posting the video Microsoft flagged at the copy I did and I'm lazy to change the strings again if you want to create a mini cats that bypass the defender check out the video or just turn defender off so let's go open up huh I don't need to open up Chrome I know what mini cats is stored I'm a professional I've done this before so get clone HTTP github calm gentle Kiwi mini cats and then we want to go into mini cats let's do this through this I think this is in UAC I'm not positive but to be sure let's go in mini cats no it's not built for us darn it that's good ie because if I go chrome chrome doesn't like us downloading mini cats because it said it's a virus so github calm gentle Kiwi mini cats and then we want to go to releases and then download it so download the did dot zip open and x64 I closed it so in the temp directory exited that is annoying Mimmi cats releases zip open x64 don't close it minimize it and then copy this to the desktop so now we can just launch mini cats run as administrator and yes and then we can go into Chrome I shouldn't keep closing windows I'm trying to not have a hundred things open and it's definitely backfiring but let's go back to our Cabana Hulk hunting and we want to go to discover and we'll do sis Mon what I disabled you clear history and of course I closed ie see this is why I had the plans to make this all undetectable real-time protections off let's just set a exclusion add exclusion folder see : users hip sack select that folder see do we still have mini cats we do not own oh we do it's just underneath this window nope it's gone okay so let's do this one last time now that defender should be excluding everything so download memory cats zip open x64 I closed ie oh this is gonna be the time it works releases source code open minimize and that is not it source x64 copy many cats do the desktop and then let's run this with UAC and then we can do a privileged debug set your OS a logon passwords and then look in hell at cysmart events that have mini cats in it because we know the executable name this will just help us filter out to only events with mini cats and we can see what it's doing so let's look at event IDs so I can just click add here and just show all the event IDs so we want ten this was one of the Sigma rules so this is doing a access process where is target process here we go process target path L SAS and the grant where is grant let's search granted access 10/10 and before they said like forty ten or something so that Sigma rule appears to be off and if we wanted to we could just do let's do event ID is ten and target process I thought its target process name why didn't that not show up what was L SAS a no SAS process target name so and process target name is else a study XE let's see if this works so if we add process target name to a table we can see everything that is talking to else s and if we add the grant granted access this will add all the numbers so we can see 10 10 1000 1000 1000 1000 14 10 so if we want we can search for a process granted access try to copy that is equal to 0 X 10 10 and only mini cats has that one so this definitely does stick out so what we can do is look at mini cast to see exactly why it did that so let's open up sublime do file open folder Mimmi cats select folder let's go into mini cats modules SEC your LSA and let's see it's probably SEC you oh Sh C and I think the function name is like LS a acquire acquire LSA so here we have the code that many cats uses to access LSS and the first thing we're doing is assigning the process rights and giving yourself process VM read and if Mimmi cats major version is less than six we're doing process query information otherwise we're doing process query limited information so my guess is maybe this is for like mini love or something that's old and process query limited information is a new call in like Windows 7 or 10 so or maybe even XP added it I'm guessing that's a relatively new call and we're seeing like backwards compatibility right here and then after it does that we can look at what it does with process rights we're creating a handle to open the process else a star exe with it so if we want to we can look at exactly how it gets to 0 X 10 10 so let's look at process VM read we open this google this and then search process query information and go to the Microsoft page and it's going to describe everything and also give us the hex so process limited information is 0 X 1000 and then the next one we want is let's go back it is process VM read and that is 0 X 10 so it does a it wise or operation or or operation which comes out to 0 X 10 10 so that is why we're seeing that inside of - Bona so if you wanted to you could probably modify some of this or just add a random handle and that may fool like an EDI solution if it's just looking for a 0 X 10 10 only enough let's see what the signal rule was because that signal rule was not 10 10 so we'll do Sigma rules Mimmi Katz else ass and let's see what this detects so this is saying 0 X 14 10 so we look so we did query information so this was 1000 limited information so query information let's see what this is go back here this is 400 so instead of limited this is limited this is VM read and this is all so I'm not sure this Sigma will really detect anything because maybe it was an old version of mini cats that did both query information and limited information because all three of these equal 14 10 I would assume on like mini lover and on an old distro it would be 0 X 4 10 because you don't have this limited call so maybe I'm misreading how that signal rule works but that one may actually be broken we want to I guess we can just show one last thing let's play with the command line logging so let's go back here - it was under system we can take away all our searches and why is what are we looking at oh because we're probably in a very short time frame so let's where is the time click this click quick will do today and we can probably just search for let's just do was it flash ad net1 its security we actually want so I want to do event ID 4 6 8 8 so we can do event ID 4 6 8 8 it's not a comma and let's get rid of these columns and we want to add the I guess process parent path oh there's parent name let's do that one that'd be less text name there is easy if we just expand this so we want command line and we also want process name and we want command line so now if we minimize this we have the parent name the process name and the command line we can do auto refresh 5 seconds and sort time so it looks like it's already newest first and we can set this to be last 15 minutes I thought we'd get rid of some noise we can set this to be last 5 minutes still has a bunch of things but let's open a command prompt and then do find dot bad stuff this is gonna be a syntax error net user EPS ACK and then we can do please subscribe / add which longer than 14 sure access denied because we're not in UAC so let's do a UAC window and do net user if Zac please subscribe and I think that's my current username so maybe I don't need slash add I do not so we can already see the commands showing up as explorer launched cmd.exe let's say we can turn an auto refresh off but let's see but I just grabbed this window so Explorer launches cmd.exe then CMD does con host then we'll probably do Explorer again here's consent this is the UAC so we're giving ourselves a elevated prompt and then running command and then doing another net user that fails and here we'd have me changing the password for it set to please subscribe so really handy to have this type of thing in your environment we can also look at like dashboard system on dashboard and see what's here we have mini cats browser system on file name I'll have to find out what these are and why that's not working we can see registry information hashes the process names and then the discover thing to see what's going on in a system dashboard is nice but I really like just having the discovery tab and then exploring for things like the elastic looks which we have not done yet so let's go to the master alert status index get rid of this event ID query and we're going to submit it for today and when we go to some of the earlier alerts to see exactly what so noisy right here so let's get rid of all filters or whatever these are called and let's add some new ones so let's expand this one and let's add C to this a this field the rule name so we'll toggle this column and then we can see rail service installs is going off constantly so this is where the understanding the architecture is really gonna help so let's also add this column and we can see it just keeps on flagging for this like constantly so let's go and check out the rule for rare service install going to the health stack let's do sudo docker PS put my password and do West - capital s we want to go into the health - alas turlet and then we can do sudo docker exact IT - so the modules do have a debug thing so but before I do that let's do a quick Google Spector ops elastic a would help maybe this will pull up the post I'm thinking about I believe yes this post explains a lot so I'd recommend reading it but I want to go over the basics we already know that Sigma rules are created in this directory and what a Sigma rule looks like let's do find up Sigma rules grab service and we can cap this rare service install yeah more and we can see it's doing event ID 70 45 seven days and if that service is less than 5 display and alert so this is really cool because it would also flag on like a single box being PS exact until so if a single service for seven days is installed on less than set five systems that's what the alert is but that doesn't translate into ELQ so if we go to home slash rules we have what the auto conversion process does to these rules so if we do LS grep on service or serve we can cat Sigma win malicious service install or not malicious we want rare service install so cat this we can see the buffer time is seven days we got this query the minimum threshold is five so everything looks good until we get to this really thing this is the silence so since this is set to zero days it's never gonna silence this alert and going to keep on playing the alert so if you wanted to you could do go back to the home where you have configure mo and you do Python and M a last alert dot o last worked and this should say like the usage instructions there we go you have to add dash H so we can do - - verbose or we could even do debug - - rule and we have to get that rule name so let's just do find grep rare grep sir grab this rule name I should copy this first and then paste the rule and that should be it so it's gonna run again it sees no alerts sent but that was the very first it's gonna run again and do the time delta from this run and the next run and tell us if that thing ever triggers so let's see what happens it's gonna wait 30 seconds there probably another 15 seconds I'll speed up the video and it doesn't look like it's or anything we're gonna let it hit one more time and then we're going to do it again but change the time yeah it's not finding anything that's odd so let's do - - start that T the time will do zero zero zero zero and try this and what is my rule Sigma windows rare service install going back to this rare service installs there we go so I'm not sure exactly why I needed that start thing but we can see it did trigger oh because it probably has to see the install so it had to start before we installed this service so we see the alert triggers and we keep getting these alerts one for each thing sis Mon 64 sis Mon driver and cmd.exe and we got the alert again so if we edit this alert file we go into rules can I do a V yeah there we go rules and change this really to be let's say what the buffer is seven days we could even set one on both if we wanted to and now we run this alert again we see it's got hits and we're going to wait 30 seconds and it should tell us that all these are silenced so it's not sending a message and there we go and it's ignoring match for silence drool and that's it so if we were to let this run again it'll ignore the match yet again and then we will create a service and let this um flag it so there we go you see everything is silenced between these two let's go back to our windows box and I think it's let's see CMD I think it's SC create service please sub then there's a binary path of bin path let's see SC create service name so please subscribe then path is equal to C : windows system32 notepad.exe we have created the service please subscribe if we go into services.msc we should have a please subscribe service right there so let's go back into our Hulk wear debug is and see if this runs and finds please subscribe there we go and we have ro named rare service install bin path notepad and it is adding it so that is how you play with these alerts and fix them to get your Sigma alert panel less uh noisy so we go back and we can just do relative last 15 minutes we don't see any of that spam that we had saw before because if you look way in the day you should see this thing going off why every minute more than that like so 1932 here 1932 down here it was just spamming or alerts so yep hope you guys enjoyed the video take care and I will see you all next week