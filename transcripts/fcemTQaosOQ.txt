 hello I'm Nick polino and this is a guide on how to exploit the debug server in the sans holiday hat challenge 2016 I'm going to assume you already have a way to run an apk file and send it through burp suite if you don't there's a guide am i right up it uses the Android SDK to set up a Android VM there's other ways to do it like genymotion or blue stack I just chose to go the Android SDK route and once you have that set up copy the apk file over to your Kali box and we're going to disassemble the APK with apktool so we're on apktool D and then the APK file name we're doing disassembly not decompiling because we're going to want to make a change pack to backup and send it to the phone if we D compiled it we get more easy to read code but we just can't package it back up so disassembly is the way to go here apktool disassemble everything and put it in a folder so let's go in there the challenge wanted us to do something with debug so let's grep this for all references to debug there grep R for recursive so it goes in to directories type debug and we'll just put a dot so it goes everywhere from this current working directory right off the bat we do see one interesting hit debug data enabled and that is set to false so let's set this over to true save this file and I just grew up with fee there we go and then the next step is go up to one directory and we're gonna run apk tool again to build this and that is the only change we have to make to this to enable the debug mode so apktool build Santa Graham underscore 4.2 and haneda it's gonna build it's checking this moly and don't take probably 15 to 20 seconds to build a little bit shorter go back into this and we have a new directory it's the dist and this where the apk file is but we have to sign the apk before we push it to a phone and we're gonna use open SSL to do that the first thing to do is make a directory called keys and this is just gonna be for organizational purposes you don't actually have to do that step and then run key tool - Jen key - V - key store Keys slash Santa Graham dot key store - alias Santa Graham - key algorithm will do RSA key size thousand twenty four signature algorithm sha-1 with RSA validity how long is it gonna be good for ya 9001 sounds good and that is in dayz keys from a password password doesn't matter this doesn't matter either so it's gonna go unknown I'm doing this slow because it asks if it's correct if I hit no it's gonna go to this prompt again which is a little bit annoying so put yes there and it wants us to type a password again and I could have just hit enter for the same password but I just say password the next thing we do is run jar signer to use the key we just generated to sign the actual apk file so draw a signer - cig al sha-1 with RSA digest al 1 - key store kia slash Santa Graham oh crap I hope this just doesn't have tab all to completion to make a mistake in the last step oh then dist Santa Graham underscore 4.2 dot and the apps name is Santa Graham let's see if this works Oh cig I'd have a type of there password warning okay Jura signed we have a signed apk file so we can go into the dist folder and that's what we're gonna have to push over to the phone so let's go into a different workspace but we have burp suite up and running run Android and this will pop up the SDK I'm gonna go to manage avds start this you know and androids going to be running the one thing I'm gonna have to do is uninstall the sand exam that's already on my Android emulator I want to include this step just because you may already have it on it and installing it's slightly different so we have the Android emulator up and running we can go back to a previous workspace with the terminal and run 8 a PT dump badging on the apk file and we're gonna draft for package and when we uninstall we use this name nots anagram the other way we could do this is on adb shell p.m. list packages and abies not found spits not in my path so locate - earth for regular expression adb and we want to terminate that so export path equals path : this so add the Android SDK to my path and now I should be able to an ADB yep so adb shell p.m. packages is it just package packages list adb shell p.m. I'm actually not sure how to do with ADB full disclosure I'm not a Android guy so we're just going to do it the way I did the first time hey Peetie dump badging to get the package name and now we're gonna copy this run a DB uninstall and then the package name and to show that it was on my phone previously let's go back to this try to swipe to unlock swipe to unlock there we go or super secure passcode swipe up and we do have Santa gram on this so running this ad be uninstalled it is successful and Santa Grahams no longer on this so now we want to install a new Santa gram so adb install santa gram success and we have the app up and running so i'm going to turn this proxy off turn it intercept off and we're gonna open this look at history huh needed account i'm gonna have to create a new one now how do I hide keyboard we can scroll down need an account let's do it sec at mail and naida dot-com password super secure password sign up and it's not doing HTTP history so something's not happening in but traitors to all interfaces and we should start seeing stuff go through target there we go we have wwws for wonderland so the app is coming through and we just got played with this app until we see something from the dev if I recall correctly to get to dev we just have to edit a profile we can put something about this and then update and we get the dev so we can go to http history see this request send this over into repeater play this and we can see what the response was we're sending a JSON string with few variables and getting this as a response when our thing is it's as verbose is set to false so what happens if we just change ours to say verbose true can we set that variable and get more information turns out we can and we get the file name of the mp3 file somewhere right up here there is debug 2016 bunch of numbers - azir mp3 that's just a file in the web directory go there download it and the challenge is done rather simple challenge the big hurdle was just being able to modify a apk file and push it back to your device hope you enjoyed this walkthrough take care and have a good day