 what's going on YouTube the zipsak and we're gonna be doing a vulnerability assessment on Hulk and hopefully showing you how to do security on vendor web applications that you don't have a lot of control over we do this by implementing a reverse proxy to send all requests through and that reverse proxy puts things through mod security and SSL mutual authentication to make sure they're not malicious and they're coming from an authorized source anyways I think Hulk is a really great candidate for this type of assessment because it's a weekend project built for testing and validating techniques to facilitate learning in a lab environment hence white is still in an alpha state but the application itself works so well I bet people still decide to pilot it and we all know pilot means production in lieu of testing so let's do some security testing to give them guidelines on how to use this application safely but before we get into the fun stuff I do want to explain my methodology of a vulnerability assessment or at least how I approach them because that will sum up everything that we cover in this video the first step is to justify or limit what services are exposed and we do that by running and map and necess to identify all the ports we can see then review the documentation to identify what each port does and close the ports that we don't need to be opened and then the next step is to place a firewall in the middle of communication to prevent unexpected data from traversing the network this doesn't have to be a network firewall we're gonna be using mod security which is an application firewall specialized for web servers and that will help us prevent any type of cross-site scripting SQL command injections template injections shellshock etc from reaching our server so in the case of a zero-day hopefully we are protected against it then the next step is segmenting access to those that need it and the basic philosophy here is saying if there's a server out there in the forest that is vulnerable but there's no one there to exploit it are we even gonna consider it vulnerable a good example would be Eilers the lights-out management that provide remote physical access to servers if the only people that talk to those are admins then why would an admin even bother exploiting the ILO because he has admin over the server anyways why even have that ILO be presented to users and give them that attack surface so we're gonna be segmenting access through SSL mutual authentication and essentially that means the servers won't talk to a user unless the user has a special certificate that says who they are and finally we have keep software up-to-date which many people believe to be the most important thing to secure in a network and I just don't I'm not saying don't update your stuff because you certainly should I'm just saying if the only thing that stands in the way between you and getting popped is your ability to patch before the bad guys read blog post on Twitter reddit or exploit DB you're gonna have a bad time you have to have other measures in place to stay ahead of that hole one day exploit wave or whatever it is called or just pen testers in general so with all that being said let's get into the fun stuff and perform a vulnerability assessment on health the first thing we want to start out with is viewing what ports are exposed to us and we're gonna do that by running both necess and nmap we're gonna do Nessus first because it takes longer so once we kick it off we can let it work in the background right now I am SSH into the health box to make sure my credentials are good they are so the username is hips ACK and the password is please subscribe so I can go over to necess log in and create a new scan let's do an advanced scan the name of the scan is gonna be help the IP is 170 216 1010 we're going to do a discovery port scanning one to 65535 is all ports go to credentials SSH password username is if SEC and we're gonna put the password s please subscribe I gotta type this twice so I'm just putting it here and then boom will elevate with sudo username is if SEC password is please subscribe that looks good let's go to plugins all plugins are enabled so let's launch the scan so while that launches let us do our manual and map of the box to see what is exposed so ed Matt - P - one semi - sixty 10:10 this is gonna check for all available ports and we see quite a few are open so I'm going to create another pane and I'm gonna make notes - ports and stir it off we have 22 which is SSH this is needed for administration if we're doing a securing linux box video we probably just enforce public key authentication only and get rid of password logins and do things like fail to ban and things like that 80 and 443 these are gonna be web services and needed for Kabana / searching logs 5044 this is unknown it's not known we can just go up here do a docker PS last - capital s permission denied so you doe double bang put the password please subscribe and that will run the last command I had done so we can see port 50 44 where is that this is tied to logs - if we go over to the Hulk design log stash is here it only talks to Kafka and the service that we need to talk to or these so since these go through Kafka and not to log stash directly we can probably safely close off this port so let's go down this is log stash unknown purpose probably safe to close 80 88 that is Kafka k SQL Server and K SQL is sitting here so I'm guessing that's the one that's open it only talks to Kafka so that is k SQL probably safe to close and then 85 31 let's go I don't see that anywhere I have no idea what 85 31 is so let's close that netstat Aon P that's not found - LTP and let's see 85 31 it's not tell me what process is using it and we'll PTN no SS - H grab pin - I pin let's get rid of the T for TCP and just do LPN do we have pins here grant Pitt okay we do have pids so what was that port we wanted eight five three one eight five three one rep Pitt pseudo bangbang house - just sudo su that is docker - proxy and let's do less - s users Dhaka proxy PID 1837 so P SEF grep 1837 and that is container 172 1805 so sudo docker PS last - capital s 1805 who are you 172 does not tell me the IP s it does not there's a doc command for that it's um we'll just do sudo docker inspect and then loop that with sudo docker PS aq and then we can search for 1805 and then search now for a name and we get logs - is that port and was I just blind let's do sudo docker PS last - s and logstash is here and 85 31 is indeed a log stash port so let's do log stash unknown Rob's safe too close so the last port we have is 1992 and from my when log beat config I know that's where we send logs so we send logs and that is not elasticsearch Kafka so it's very important to do things like this because one of these services I know is relatively unsafe to expose so let's close out of that and clean up a terminal bit we'll see if necessary thing it is done so let's look at this report and we only see two mediums one low and the rest informational so we see the mediums are probably going to be these SSL issues which are probably safe to ignore the other ones nothing of - interest we have a detecting nginx let's check the authentication it was successful on authentication let's do ports port port scanner and should see all the same ports we did doesn't really identify them too much let's look at I don't know what else to look at so we'll just go back whoa we can search for kay SQL because that's the one we're going to manually and look at searching for that we have nothing so what is k SQL well let's see what we can do with it if we go to the Hulk github page and it is worth mentioning that ELQ is an alpha product not meant for production and it's made by cyber war dog on his weekend time so not officially supported and of course alpha state so dragons are buried I guess they would say let's go to the wiki where is the wiki here it is and he should have information on Kafka here it is down below and he has instructions on installing the K SQL command line client locally so let us follow this so go to the conflict platform download it email will do up sec at abc.com probably does not to be a valid email download and we can save the file it looks like the download is finished so let's go back to our box and just move that file here so move downloads what was the flower name confluent to our local directory and then on tour it and then let's go into the directory and see if we can find where the k SQL bin is so it's in just bin and then k SQL and HTTP 170 216 10.10 port 80 88 and see if we connect it takes probably about 5 to 10 seconds to connect and once it's connected we can do show topics and this is kind of like show tables so we can do a print when log beat from beginning and start dumping information out of the messaging queue so we can see this is certainly not our data so this came in at 1309 and it is from win log beat this is technique name credential dumping so something talked to else ass here but if we go here and enable a Windows box resume guest we should see this start streaming the box is online now so let's see there we go there comes another message there's another one a registry event another one so we can just start intercepting all the logs going to this topic so that probably shouldn't be exposed to the network and that's what we will work on closing now though always important to dig into things and not that necessary tool I do love it and use it quite often but you can't just expect it to find anything or Freudian slip there I guess find everything I should have said because well k SQL is a new technology etc etc and yeah so let's move on and start blocking ports so the first step is to find what our interface name is so we can specify that it figs on the system so I use IP addr and then we look at the interface that has the IP 170 216 1010 and it is ENS 33 so my first step is to do a sudo iptables - a input to append a rule on the input table and we're going to specify - I in s 33 - P TCP - - deport eighty eighty-eight - j drop and then we go back and let's verify we are dropping the packet to a port so specify port 8080 eight on one side - 16 1010 and we can see the port is still open so let's do a sudo iptables - capital L and look at an input table we can see it clearly says drop but docker obeys the one and this doctor - user chain so we have to add it there so let's remove this one rule so would change that capital a to a D and then we want to do an I in servant a so we insert a rule at the top because we don't want to put it below the return so I is top a is bottom so doctor - user and leave the same thing I did a under course well I think underscore yeah so now we did that rule they do an end map and it's now saying filtered and I don't like this for like internal ports so it does slow down and map scans but it still shows like a firewall is into place so let's delete that rule go back to I instead of a dropped we're gonna do reject and let's do this and map again on for 8088 still says filtered so we need to delete this reject and we want to do - - reject with tcp - reset because if we didn't do this let's just copy this and look at what rule it is and see if we can see what it says the best way I found to get verbose information is just do sudo iptables - save and we can look let's see where is the drop I don't see any rule oh we deleted it so would go back to that reject rule and we see it's rejecting with ICMP port unreachable which nASA says that is filtered so let's put our reject with TCP reset and do an nmap scan and it says it is closed so if we just do a flat out and map on 172 16 10 10 that port no longer shows up we have other ports we want to close so let's also close 50 44 85 31 and I think that was it so let's do it nmap - P - 170 216 1010 and see what comes back so we have 85 31 did I type or that I did type of that I am known for the typos that's why we always verify our work especially when it comes to securing things so we do the end map again and see we have 22 going to a justification that is needed for administration 80 and 443 that's needed for cabana and 90 92 this is Kefka how we're getting logs into our system so everything is good the next step of this video is the firewall portion so we're gonna go over to draw il to quickly draw a basic architecture diagram and then we'll start configuring everything so let's create a new diagram blank is fine and this is gonna be stupid simple so let's do workstation and we'll put ourselves here is gonna be clients I can make this a bit bigger and we can put a webserver website maybe is a better one sure I'll put this here this will be website or ELQ so how we are connecting is just going straight to it now we won't always have control over this web server for instance if it is an ILO device so one thing I really like doing is creating reverse proxies internally so we'll just put server here and we'll call this the Rev proxy and this is just going to run Apache to modsecurity and that will help prevent against things like cross-site scripting command template injection shellshock etc so and it also allows us to do SSL mutual authentication and then our client talks to this which then forwards out the request over to the health server and a client doesn't even know he's even going to this Rev Roxy but this guy since in the middle and make sure all the web data that goes to hell is good and then once we have this up we can figure the help firewall to only allow 80 and 443 traffic from the red proxy so I have created a nother box it's just joining you bunchy right now and that is 172 16 10 15 so let's go and ssh to them and it's just a most up-to-date version of ubuntu so I'm going to switch to the root user because we have a lot to do and then we begin by installing apache so we'll do apt install apache2 and let this install we could use nginx but I find the modsecurity installation on nginx to be a bit painful and it becomes a bit hard to install updates because the nginx mod is compiled from source so yeah that's why we're using apache configs a bit more difficult to set up with Apache but at least it won't break every time we update so with the patching installed let's set up the rev proxy so go to Etsy Apache 2 and then we want sites - available and we can cat default SSL Kampf let's grep - v on all these comments grant period and then send this to hell calm and we can delete the default SSL Kampf and go to hell and start modifying this so virtual host this is the IP address we want to listen to or listen on and then we can have a server name variable which would then mean if it sees that host header that has helped in it it goes down this virtual host so that's how that works and that would a well this Rev proxy to host multiple sites so the important configurations let's remove the ones we don't need we don't need server admin we don't need document route logging good as a cell engine we need don't need these and we need to put a proxy requests off proxy preserve host on proxy pass everything to http 172 16 1010 proxy pass reverse on HTTP 172 16 1010 and I think that is what we need we need actually SSL proxy and gen on and we need to probably enable mod SSL proxy and things so a 2e n mod SSL and we want a 2e n mod proxy and proxy HTTP proxy HTTP okay so we did those three modules proxy proxy HTTP and SSL so we can do systemctl restart Apache 2 and go to a Firefox browser 172 16 10.15 and it goes to Ubuntu page oh we want to go to HTTPS secure connection failed receive a connect that received maximum length let's go tale ver log Apache error log 4 log Apache of the host and it doesn't look like we did an HTTP request I'm guessing it didn't send a HTTP request to kibana so let's this can figure out again and wait sites enabled and there's the error we never actually enabled our site so what's listening on port 443 isn't configured to so let's just enable the site hell Kampf and it wants us to reload the configuration so we'll do that and all that enable site command does is creates a symlink and sites enabled that points to the configuration and sites available so if we refresh the page now we should get that SSL certificate and if we accept it we get another error message so let's look at the Apache log and see if we can figure out what we need to do so Apache to arrow dot log and let's see service certificate does not include ID which matches server name that's a warning so may be fine air pass request bot to body failed and it just dies so what I'm going to do is enable the debug log so it's good a log level whoops and change it from one to debug and I'm going to clear out the Apache log I'll do that once we restart so reload Apache wipe the Apache log then refresh the page and we will cat the log and we get a lot of information so let's grep for error and let's see body failed SSL handshake and that's exactly what we expected well what we saw before so if we tale it let's see we see it grabbing the certificate of Hulk peer certificate not match Harris name and then it closed so maybe this is what we want this info so I'm going to go back into as a cell config and we're gonna do a bunch of things that are I guess maybe bad so we'll do SSL proxy verify none SSL proxy check PR CN off SSL proxy check pierre name off I think these two the same thing I think pair name is the newer one of CN and then we'll also do SSL proxy check PR expire off so now we're just accepting any certificate it gives us so let's reload the config refresh the page and we get a login prompt which is good so help and hunting what DNS lookup failed for one set me to sixteen ten ten app I'm guessing that is going to be a configuration proxy pass we need to put slashes on the end of the IPS reload and there we go so now we're reverse proxy is configured the one thing we want to do is take Apache out of debug mode so we don't fill or logs so put that back in one reload and we should now be able to begin installing mod security so I'm just gonna go over the discover tab real quick to make sure we get some type of logs to make sure this is working so user aggression test I guess last twelve hours on sis Mon we see data so I think it's safe to say Cabana is working so let's go back to a root and we'll begin installing mod security which should just be in apt so we'll do app search mod - security maybe no - let's do at edit sources we'll do two of them basic and I think it's in the universe package so will enable universe and this is like maybe I don't know what a good way to just could describe this is not officially supported but probably stable so maybe that's the best way so do apt update and we probably should do an apt upgrade afterwards but I'm lazy and it should be fine since all we did was enable universe so we'll do apt search mod security and there we go we have the package so we'll do apt install Lib Apache - - mod - security - install that and we see from this script it's already in labeling the module setting up modsecurity crs which is the core rule set which is amazing so the core rule set is more of a level beast so just one bad thing may not flag it as malicious it does multiple levels and multiple checks and identifies if it's bad that way if like something's coming from Amazon AWS you don't assume it's malicious right away but you add like five points to it and then when it has dirty words like select exact etc then you add another point to it and let's say we drop everything at seven points and the dirty words give it three points the AWS gives it five you're above seven which drops a packet and if you just came from what looks like a residential IP chances are it may not be malicious and doesn't give that extra five points tacked on because it came from Amazon and now it thinks it's a good request and passes it so you can do a lot of really cool things with mod security and cool rule set so let's go to Etsy mod security and we want to just move mod security recommended to mod scooty Kampf we can look at mod security calm and see what it is it's in detection only and if we go into Apache config we can actually override this to say we're on and actually block but in this mode it won't ever drop pages it'll just alert you so let's I guess reload Apache which it probably did and we can probably go to log Apache - and then we got mod SEC audit log so we'll look at this go back to a reverse proxy and we'll put slash hip SEC is equal to slash bin slash bash and if we look at this we see a bunch of things that may have flag that oh my god there is so much here it's flagging probably on something Kabana related so this is requests 9:20 protocol enforcement host header is a numeric IP address okay that one's probably fine we can ignore that let's see there's a lot more work than I thought it would be here maybe let's just turn it on blocking mode and see if we can get it working so let us go to Etsy apache2 sites enabled help kampf and we will turn modsecurity on so we will add SEC rule engine on and restart Apache and then when we go to question mark if SEC equals bin bash we get it forbidden which is good if we go to just kibana it looks like the page is loading to discover and we get authorization exceptions here so let us go back to mod security and look at the mod SEC audit log so score exceeded total inbound score is 8 don't see SQL injections cross-site scripting request forgery RCE PHP whatever so let's see content is not allowed by policy tag event correlation see this is probably hope that's M search let's see what is this flagging that's all think Asian pattern match let's just grep message so grep message mod SEC audit log that - hi message - a - I so let's do last - capital s go to the bottom and see what we have a lot of protocol enforcement tag application IP host so maybe if we just went to this page as a domain name it may not block so let's try that so in our Kali box be Etsy host we're going to say 10 10 10 10 once I mean to 16 10 15 is going to be WWE elk dot local we'll say so here you can do dub-dub-dub health local and we have to do HTTP advanced at exception confirm pilk on tang go to discover and we still get authorization issues so let's go back to SSH and look if we have anything else so I'm going to clear this log we will refresh the page and see what it's set refresh the page and see what it says so on discover come on get that error message there we go so let's see where is earthing request content type is not allowed by policy so content type what content type are we encoding application multi there it is application /x - ND json so let us search or logs for content type and enable that so let's go to Etsy mod security CRS that's not what the rules are where are the rules let's do an update DB to update our file system now we can do locate mod SEC and the rules look like they're in user share of mod security so user share mod security rules and we can grip for a Content - type on everything looks like it's an request 920 protocol enforcement look for content type which content types we accept going here we get a variable allowed request content under square type so let's grab content underscore tight on everything and it looks like on request 901 initialization we have a set var it is right here I just don't want to click to erase my clipboard so request 901 search for content underscore type that's not it here we go looks like we just put a pipe for and and then paste application X Dash and D JSON so now we can reload Apache and we can refresh this page and see if mod security is now working all right now not no longer blocking us so we don't get that authorization thing which is good if we go back 12 hours we are good and let's verify that everything is working by doing like if SEC is equal to a slash bin slash bash and we get error message there so I think everything's good so let's do question mark if SEC equals slash bin bash yep so mod security definitely is working but it doesn't look like it's blocking legitimate requests which is good so let's just double check to be positive because nothing's worse than implementing a web and blocking mode and then having it block of VIPs requests so yep there we go so everything looks good if you see error message when you're doing searches chances are it may be mod security blocking your search if we search for like bin slash bash no error message popped up so it doesn't look like mod security blocked it but let's move in to the final part of this video which is going to be the mutual authentication to make sure that only authorized people actually talk to this Cabana instance to do that we're going to go back to our local box and create a certificate authority so I'm just making the directory CA but if you were to do this you may want to put this on like an encrypted PGP drive or USB Drive because these files should be considered extremely sensitive and not really stored in a place where they could ever be compromised because if someone commbuys your CA it becomes a huge pain to rebuild and they can do a lot of things like man the middle all traffic and just destroy a SSL in general so what we're going to do is create a notes file real quick to explain everything so the first thing we have is the CA is private key and this is kept offline used to sign stuff that doesn't be kept on any server whatsoever then we have the CI certificate authority public key and that is going to be kept everywhere everyone needs this this has like the trust hierarchy and everything so after we have those two we have the website private key and the website public key and this is kept on the website and the website public key is distributed to users and then we have the user private key and this is stored in the web browser and the user public key will be what is sent and these two things I can do this in any comprehensible way get stored in a pfx file so I think that explains it hopefully I explained it correctly I'm not an expert on SSL so it's my understanding of it so the first thing we have to do is generate that certificate authority so we'll do open SSL gen RSA the encryption which will be a AES 256 out see a key 4096 and at a passphrase for the key Center it again I can't type there we go we have created the certificate private key so now we have to create the public sir so do open SSL request new x.509 days this would be good for one year the key this would be the private key and - L will be the certificate and with the password for the private key and now we got to create something so we'll do u.s. New York New York organization name awesome cyber guides unit name epic and the CN for this will be internal CA email addresses nothing so now we have two things we have the public key and the private key for CA so now we have to generate stuff for a website so we'll do open a cell gen RSA AES 256 oh now open SSL request new key RSA 2048 nodes key out and this will be held key - L help dot CSR and will do us New York New York was it awesome cyber guides is that what I said before yep when ization will you know be hip SEC and the common name will be WWL cloacal no email address and we won't worry about a password here so next thing we have to do is sign this key so we do open SSL requests no x.509 requests days 365 help dot CSR and when we did this file if I said that was the public key I was wrong that's certificate signing request I'm kind of just on autopilot - ca ca ca t - C a key C a key set serial oh one - out this will be help dot hey sorry I typed in it should be in there and this will be help dot key I think or no CRT this is the public shirt so this is the websites public key I think that's all good unrecognized flag see a key maybe it's a lowercase there we go and the password for it and now that key is signed so we have to do that same process but for user certificate so we'll set the zero to two and we'll do in now we need here we go this one epic epic so we do OpenSSL request new key or si nodes key out upset key and then out upset certificate signing request to create our stuff so do us New York New York organizational name awesome cyber guides hip sack common name hip sack and we won't worry about a password and we have to sign it so we do a Copa nacelle x.509 requests days 365 the in file is checked out certificate signing quest CA is the CA set the 0 to 2 and will output EPS X ERT so now we have everything signed so what we want to do is copy the correct keys to a health survey or the reverse proxy so we'll do SCP help stir 2 epic at 172 16 10.15 put a password in and I type out that okay we have copied all the health stuff so we go back to our SSH go to Etsy Apache to look at where our SSL certs are stored so sites available he'll calm and we're in the SSL cert snake-oil stuff so Etsy SSL and then we'll copy the CRT file into certs and then the private key into private so copy hip sack he'll quixote and asserts and then help dot key into private and the last thing we have to do is edit the config so he'll calm rename these keys to be healthy ot and help dot key and we also have to do the SSL see a file so SSL certificate now SSL CA certificate file CA certificate file is equal to Etsy SSL certs CA we called it like internal see a dot CRT so we just have to copy that last one so let's go back to a bash window and SCP see a CRT - if SEC so please subscribe go back CP if SEC see a dot CRT in - lets see SSL certs internal CA c OT i think that's what we called it internal see a CRT reload and when we refresh this we get a SSL warning we go to add exception and we view this we can see this is indeed the certificate authority so if we trusted this CA to identify websites for us we won't get this error so I won't click through this if i refresh we still get that so let's add our CA so go into preferences of Firefox certificates and then let's do a Thorat ease import and we want to go into root and it's under help ca ca CRT to identify websites and if we refresh this page we don't know long get a certificate error so our CA does work the only thing we have to do now is configure Apache to require client certificates so let's go back into hell Kampf and then at the very bottom we can just put SSL verify client require so we'll reload refresh the page and we get an SSL warning because the server cannot verify who we are if we go into VAR log Apache to and should tell us we have issues will do tail - F maybe it will maybe it won't nothing in error tail access doesn't look like it tail other nope I don't think it's telling us so we probably to play with logging to get that yep does not but as you can see we can't view it until we go into our certificates go into your certificates import and then we have to do the pfx creation and that's what we forgot to do so go back to a box and we have to create that pfx file so we will do open SSL pkcs12 - export out if set be FX in key eps a key and then - n will do if sexy or t and i think that is good export password we'll leave it blank and then we got a PF x now so let us go back to firefox and port that and you probably should put passwords on these things I'm just not because you see how then I type Oh passwords and for the video sake I didn't feel like doing that so now when we click try again we get a prompt saying the site requested us to send it or a certificate and we're sending it or users to forget saying hip SEC and now we can't authenticate to Kabana so we now have the mutual authentication done the only issue we have left now is our Cabana instance is still listening on 172 16 6 16 10 10 so we just have to remove this access and then we will consider or Cabana secured so let us go back into the actual Cabana server which is here and we are on route at ELQ so let us do I pee tables - capital L and we're going to add reject rules and accept rules so we'll do I pee tables - I and then dr. - huh history grab IP tables I don't know where that went so we'll have to just retype the drops so we do IP tables - eye doctor user - ie and s33 P TCP deport eighty - J drop and we do four for three as well so now if we go back and try to access Kamata on 1010 we can no longer do that so the downside is right now a reverse proxy can no longer do that as well so we're going to do - i ns 33 now we want to do drops with dzp resets yeah we won't worry about it you saw that early in the video so instead of drop we want accept and instead of port 443 we do - s1 semi - 16 10 15 and if we now refresh this Gabanna is working but the Cabana here is not working and if we go down and end map on 172 16 10 10 we will get only point 22 is open and remember these are filtered because we didn't reject it with the TCP reset we just decided to drop it so the last thing I guess we do is have IP table save some when we reroute the box where IP table is aren't just reverted so we'll just do apt install IP tables persistent and start installing this package save current v4 and then v6 I forgot about v6 so this would be a fun one if you haven't watched a lot of my videos there's actually probably a way around everything we just did because ipv6 link local so as long as you're on the same subnet as this server you may build a bypass it so let's do IP addr look at ENS 33 and we see this fe80 address so let's confirm down here by and map we cannot access it everything is filtered so let us do and map - 6 put the ipv6 link local and then because it's a link local we have to do % the interface we want to scan from which is eath 0 and when we scan this everything is open and that is because the rules we changed we're only for the 4 not v6 so v6 is still left open and everything was listening on it which means we have a little bit more work to do before we can consider this box secured so I'd rather just completely disable ipv6 because I don't think anything's using it so let us begin by we gotta edit the TL stuff so that is Etsy TL Kampf let's just go to the very bottom and do net ipv6 Kampf all disabled ipv6 equals one and then we'll do net dot i pv six Kampf default disabled IP v6 equals one and then we got to edit grub so Etsy default grub and we have to do the CMD line linux to also have ipv6 disabled equals one and grub CMD line i pv six dot disabled equals one it is a pain to disable ipv6 and then finally we have to rebuild grub with update - grub and once this is done we can reboot the box and make sure everything comes back so rebooting and i will resume the video once this comes back so pausing it now the box should be back online so let's SSH to it do please subscribe sudo su and if we do iptables - shell we can see everything is still there we do IP addr we can see en s33 does not have any ipv6 stuff so it looks like everything was successful if we do and map on that ipv6 address it is offline and if we do n map 172 16 1010 we should only get 22 is open 80 and 443 are filtered the rest we blocked correct way and if we go into a reverse proxy let's see what happens we are loading Cabana so everything looks great we should have 90 92 or something open and that may just be because I didn't do - P - because without that we're not gonna be getting logs into Cabana so everything looks good I think we can call it a day saying we did a good job securing this application yeah take care and I will see you all next week