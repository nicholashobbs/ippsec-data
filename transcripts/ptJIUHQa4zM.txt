 what's going on youtube this is ipsec me doing explorer from hack the box which was an easy android box as long as you ran nmap with all the ports and were able to identify some http services listening on high number ports because if you just do the normal nmap all you see is port two two two two which is running a weird ssh server and nothing else but if you run an nmap with a full port scan you can identify a application that listens on a bunch of http ports which has some vulnerabilities in it that allow you to download files off the android phone one of those files being a picture of some credentials on ssh so you ssh your way in enable adb by setting up a port forward and getting root through the adb console with all that being said let's just jump in as always i'm going to start off with an nmap and i'm just going to specify oa i'm not going to do any other arguments because i haven't ran nmap on this box before and i just want results quickly so first i'm going to create the nmap directory call it explorer then do 10 10 10 247 i'm gonna do dash v so it shows me open ports as it finds it and i'm also gonna set dash dash min dash rate to be 10 000 packets per second so it should finish this almost instantly we do have two ports open it is two two two two and five five five five and it should be worth noting that five five five five is actually filtered so that's not open um it is explicitly blocked though by like iep tables or something because it is saying filtered so we know something does listen on that port so the very first thing well the second thing we're going to do is sc for default scripts sv enumerate versions dash p to specify a port and i'm just going to do a nmap on port 2 2 two two so this will get me the header of that ssh often runs on port two two two two so that's what i'm guessing we'll be seeing probably could have done ssh-v to get it but nmap does such a good job at pulling banners we can see it is banana studio so i'm going to grab this and we're going to go to google and do ssh banana studio and see what this returns and it looks like it is some type of android application so i'm going to start a full nmap scan on this box because there's nothing other than port 222 which is an ssh server so let's do this nmap i'm going to do dashp dash i'm going to specify explore all ports dash v and we can set min rate to 10 000 and this may be too high for you may want to try 5000 main one try not at all and just running it but since we have a full port scan on the box let's now just go over to exploit db and i'm going to search banana studio i could be using search point on my machine but i generally still like going to exploit db because i want to worry about like my search point being out of date um but yeah so we have a few more ports i'm going to go back to my previous nmap command and we're going to specify the new ports we have so three five nine six seven then four two one three five and five nine seven seven seven so we don't know exactly what all these ports are we do know this is an android box so i'm just going to google each one while our nmap is running so i'm going to google android port 35967 and let's see android charging block i don't really get anything from that let's try four two one three five so copy this we can put that here and this is es file explorer oddly enough it's saying port 5977 um which is the next port open so that is a bit odd uh android port so maybe this application uses both uh ports so we have a exploit script here for it and it looks like it is uh just a application that listens on the web so while that runs i'm going to do curl 10 10 10 247 port 5977-v and we get a response back it doesn't tell us what the server is we have a 500 content type text plain and we have just a response saying it aired out so what i'm going to do is grab this module i'm going to go copy v exploit dot pi set paste paste that in and then we can do python 3 exploit.pine hopefully it tells us how to use it it does it says command ip and then file to download so what we want to do is look at this exploit so i'm going to v exploit.pi and see what commands there are um the very first one i'm going to do is get device info because this seems to be the safest as in like there's no way this is ever going to fail we could try list files but if there's like no files to list no pictures to list i won't know if it actually worked so that's why i'm going to try get device info so let's go back here we can say get device info ip101010 247. and we get name vmware virtual ftp root sd card and ftp port 3721 i'm going to look at the ports we have from nmap if 3721 was one of them it is not but the scan has finished so let's go look at what results we have so oh that's a lot of things on three five nine six seven it's some type of web server but we just get a bunch of gibberish back uh four two one three five we have this file explorer and then five nine seven seven we have a weird json api i think it's like miss flagging that or maybe this es file explorer just uses that but we can just keep going on with this exploit so let's look at the other things we can do let's do list files so i'm going to try list files and it looks like we can download any file off of slash so the next one i want to do is let's say list pictures uh list pics have a few concert anc creds and two to four so creds.jpg sounds interesting so what i want to do is type an error here so we can see how to use it and i want to do get some guessing i want to do get file and then the picture say location creds always sounds interesting looks like it's downloading it saved it as alt.dat i'm going to move out.dat to creds.jpg did not mean to type mf and i have no clue uh what mf was so i'm going to exit my tmux window and we're going to try this again so move out.dat into out.jpg and i'm gonna do help mf mf-h meta font no idea what that is but we can open out.jpg and it looks like we have some credentials so christy and then a hard to type password so let's see there we go echo k r one s t exclamation five h hat r p three x p l o r three exclamation point so let's just copy that and then we can copy this we can try ssh p222 christie at 10 10 10 247 accept this paste in the password kr 1 st exclamation point 5 h at rp i think i typed it right ko1 sd estimation 5h so whenever i have a question if i type something correctly i always like just typing it on a second line and then i can compare it so that looks correct putting in my clipboard that is fine k-r-i-o i have no i here and we get on to the box so let's see what we have here this is an android system i'm going to try sudo l not found look at open ports and we do have 5555 open and when we did our end map that port was filtered so what i'm going to do is google android port 5555 and we have to go to google it wouldn't be a video without me screwing the google up once and let's see it looks like it is adb so i'm going to try doing adb connect so let's do adb sudo apt install adb yes and then once this installs we should be able to adb connect and we have to for the port so i'm going to um hit squiggly c on a new line and when i do that it drops me in this prompt and i can say five five five five localhost five five five five and what this does is set up a um port forward to go through ssh so if we do nc zv localhost five five five five uh connection refused now i'm gonna for this port and now we have a successful connection because it is going through ssh so i can do adb connect let's see um localhost 5555. daemon not running starting now connected to localhost see adb console uh what is the adb command adb reboot see search for shell adb shell that's not it but it didn't say invalid command it says more than one device or emulator uh let's see adb help how do we list devices reconnect man this is a painful help probably partially because my screen is so big see adv devices dash l devices dash l and we have two devices so i have to specify probably this local host so i wonder if i do adb dash s localhost 5555 shell there we go and if i do id we are now root on um adb which is like android debug bridge i believe and this just gives us um root privileges so or a shell who is a member of root i believe if not i can probably do s u and do who am i and get root that way so now we have to find the flags so there is no slash root but android generally likes putting things on the data so let's do find oh dataroot.txt so we found root.text let's see where is user.txt um probably a home directory so cat etsy passwd does that exist here uh cat data is there etsy here nope say fine dot grant passwd i should do two dev null so we're hiding error messages hold on find out the error message is on the fine not the grep so to devno so now we're hiding error messages so if the file does pop up we don't really get surprised but there is no file here so i wonder if i can just grep for user.txt and find out where it goes so it is in slash storage emulated xero user.txt so i should be able to cap this file and we get that and then root and root dot text or was it data slash root text for that android is weird so we can get both of those flags so that's pretty much gonna be the box but this did go really quick so what i want to do is take a look at this exploit actually so let's go and vi exploit i already have it open in this pane so how does this work this is using request so it's doing post here let's set it to go through a proxy and then analyze what it looks like so i'm going to do proxies is equal to is it http and then localhost 8080. i think that'll send it to burpsuite so now if i do python3 pi um what was the thing 10 10 10 2 47 we can say download a file who's get device info is that it no proxy scheme supports at localhost so we screwed that up let's see i think i deleted this unless that just wasn't in the script let's see proxies then http we just specify http colon slash oh it had something here for it does it use this anywhere nope okay it's now in my brep suite window and go here go to proxy and we can see all it does is this post and says get device info and we can see how it responds so list files was that another one no directory listing capital f and we can see the other command of showing the files so let's go back here and let's see i think i did it down on this pane let's see get file there it is let's go proxy drop run this it decided not to send it my way intercept is on get file request so http oh apparently forget file it is not a [Music] thing or not a post so let's grab that line put it there so now when we run this download file see it still did not send it to my burp suite proxies so request.get localhost 8080. so if i do 8081 theoretically this should not work okay so it is hitting burp suite but it's just not intercepting so let's go to options uh intercept i'm guessing it's because of this file extension does not match jpeg and that looks better okay all is right in the world so all it is is literally a get on the url and it's able to download it so this piece of software on this phone was god-awful but hopefully you understand how that exploit works and that'll be the video so take care and i'll see you all next week